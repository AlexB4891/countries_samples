<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regession analysis report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="regression_transparency_files/libs/clipboard/clipboard.min.js"></script>
<script src="regression_transparency_files/libs/quarto-html/quarto.js"></script>
<script src="regression_transparency_files/libs/quarto-html/popper.min.js"></script>
<script src="regression_transparency_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="regression_transparency_files/libs/quarto-html/anchor.min.js"></script>
<link href="regression_transparency_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="regression_transparency_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="regression_transparency_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="regression_transparency_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="regression_transparency_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#joint-groups-t-maj-t-min-vs-c-maj-c-min" id="toc-joint-groups-t-maj-t-min-vs-c-maj-c-min" class="nav-link active" data-scroll-target="#joint-groups-t-maj-t-min-vs-c-maj-c-min"><span class="header-section-number">1</span> Joint groups (T-Maj + T-Min vs C-Maj + C-Min)</a>
  <ul class="collapse">
  <li><a href="#event-study-design-unsaturated-model" id="toc-event-study-design-unsaturated-model" class="nav-link" data-scroll-target="#event-study-design-unsaturated-model"><span class="header-section-number">1.1</span> Event Study design (unsaturated model)</a></li>
  <li><a href="#event-study-design-with-fixed-effects" id="toc-event-study-design-with-fixed-effects" class="nav-link" data-scroll-target="#event-study-design-with-fixed-effects"><span class="header-section-number">1.2</span> Event Study design (with fixed effects)</a></li>
  <li><a href="#event-study-design-assets-weighted-unsaturated-model" id="toc-event-study-design-assets-weighted-unsaturated-model" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.3</span> Event Study design assets weighted (unsaturated model)</a></li>
  <li><a href="#event-study-design-assets-weighted-with-fixed-effects" id="toc-event-study-design-assets-weighted-with-fixed-effects" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.4</span> Event Study design assets weighted (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-unsaturated-model" id="toc-diff-in-diff-design-unsaturated-model" class="nav-link" data-scroll-target="#diff-in-diff-design-unsaturated-model"><span class="header-section-number">1.5</span> Diff-in-diff design (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-with-fixed-effects" id="toc-diff-in-diff-design-with-fixed-effects" class="nav-link" data-scroll-target="#diff-in-diff-design-with-fixed-effects"><span class="header-section-number">1.6</span> Diff-in-diff design (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-unsaturated-model" id="toc-diff-in-diff-design-assets-weighted-unsaturated-model" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.7</span> Diff-in-diff design assets weighted (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-with-fixed-effects" id="toc-diff-in-diff-design-assets-weighted-with-fixed-effects" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.8</span> Diff-in-diff design assets weighted (with fixed effects)</a></li>
  </ul></li>
  <li><a href="#major-groups-t-maj-vs-c-maj" id="toc-major-groups-t-maj-vs-c-maj" class="nav-link" data-scroll-target="#major-groups-t-maj-vs-c-maj"><span class="header-section-number">2</span> Major groups (T-Maj vs C-Maj)</a>
  <ul class="collapse">
  <li><a href="#event-study-design-unsaturated-model-1" id="toc-event-study-design-unsaturated-model-1" class="nav-link" data-scroll-target="#event-study-design-unsaturated-model-1"><span class="header-section-number">2.1</span> Event Study design (unsaturated model)</a></li>
  <li><a href="#event-study-design-with-fixed-effects-1" id="toc-event-study-design-with-fixed-effects-1" class="nav-link" data-scroll-target="#event-study-design-with-fixed-effects-1"><span class="header-section-number">2.2</span> Event Study design (with fixed effects)</a></li>
  <li><a href="#event-study-design-assets-weighted-unsaturated-model-1" id="toc-event-study-design-assets-weighted-unsaturated-model-1" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.3</span> Event Study design assets weighted (unsaturated model)</a></li>
  <li><a href="#event-study-design-assets-weighted-with-fixed-effects-1" id="toc-event-study-design-assets-weighted-with-fixed-effects-1" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.4</span> Event Study design assets weighted (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-unsaturated-model-1" id="toc-diff-in-diff-design-unsaturated-model-1" class="nav-link" data-scroll-target="#diff-in-diff-design-unsaturated-model-1"><span class="header-section-number">2.5</span> Diff-in-diff design (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-with-fixed-effects-1" id="toc-diff-in-diff-design-with-fixed-effects-1" class="nav-link" data-scroll-target="#diff-in-diff-design-with-fixed-effects-1"><span class="header-section-number">2.6</span> Diff-in-diff design (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-unsaturated-model-1" id="toc-diff-in-diff-design-assets-weighted-unsaturated-model-1" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.7</span> Diff-in-diff design assets weighted (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-with-fixed-effects-1" id="toc-diff-in-diff-design-assets-weighted-with-fixed-effects-1" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.8</span> Diff-in-diff design assets weighted (with fixed effects)</a></li>
  </ul></li>
  <li><a href="#minor-groups-t-min-vs-c-min" id="toc-minor-groups-t-min-vs-c-min" class="nav-link" data-scroll-target="#minor-groups-t-min-vs-c-min"><span class="header-section-number">3</span> Minor groups (T-Min vs C-Min)</a>
  <ul class="collapse">
  <li><a href="#event-study-design-unsaturated-model-2" id="toc-event-study-design-unsaturated-model-2" class="nav-link" data-scroll-target="#event-study-design-unsaturated-model-2"><span class="header-section-number">3.1</span> Event Study design (unsaturated model)</a></li>
  <li><a href="#event-study-design-with-fixed-effects-2" id="toc-event-study-design-with-fixed-effects-2" class="nav-link" data-scroll-target="#event-study-design-with-fixed-effects-2"><span class="header-section-number">3.2</span> Event Study design (with fixed effects)</a></li>
  <li><a href="#event-study-design-assets-weighted-unsaturated-model-2" id="toc-event-study-design-assets-weighted-unsaturated-model-2" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.3</span> Event Study design assets weighted (unsaturated model)</a></li>
  <li><a href="#event-study-design-assets-weighted-with-fixed-effects-2" id="toc-event-study-design-assets-weighted-with-fixed-effects-2" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.4</span> Event Study design assets weighted (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-unsaturated-model-2" id="toc-diff-in-diff-design-unsaturated-model-2" class="nav-link" data-scroll-target="#diff-in-diff-design-unsaturated-model-2"><span class="header-section-number">3.5</span> Diff-in-diff design (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-with-fixed-effects-2" id="toc-diff-in-diff-design-with-fixed-effects-2" class="nav-link" data-scroll-target="#diff-in-diff-design-with-fixed-effects-2"><span class="header-section-number">3.6</span> Diff-in-diff design (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-unsaturated-model-2" id="toc-diff-in-diff-design-assets-weighted-unsaturated-model-2" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.7</span> Diff-in-diff design assets weighted (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-with-fixed-effects-2" id="toc-diff-in-diff-design-assets-weighted-with-fixed-effects-2" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.8</span> Diff-in-diff design assets weighted (with fixed effects)</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regession analysis report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Libraries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"global.R"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>populations <span class="ot">&lt;-</span> <span class="fu">str_split</span>(params<span class="sc">$</span>populations, <span class="at">pattern =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="joint-groups-t-maj-t-min-vs-c-maj-c-min" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Joint groups (T-Maj + T-Min vs C-Maj + C-Min)</h1>
<section id="event-study-design-unsaturated-model" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="event-study-design-unsaturated-model"><span class="header-section-number">1.1</span> Event Study design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================================================================
                                           All firms      Treatment A  Treatment B  Treatment C
-----------------------------------------------------------------------------------------------
(Intercept)                                   179.28 ***    121.33       121.33       113.10   
                                              (41.17)       (86.25)      (86.20)      (64.15)  
anio_fiscal                                    -0.08 ***     -0.05        -0.05        -0.05   
                                               (0.02)        (0.04)       (0.04)       (0.03)  
treatment                                       0.93 ***     -0.08         0.29         0.77 **
                                               (0.25)        (0.36)       (0.31)       (0.28)  
i(anio_fiscal, treatment, ref = 2014)2012      -0.39         -0.40        -0.36        -0.35   
                                               (0.27)        (0.37)       (0.29)       (0.28)  
i(anio_fiscal, treatment, ref = 2014)2013      -0.12          0.10        -0.05        -0.05   
                                               (0.22)        (0.30)       (0.23)       (0.23)  
i(anio_fiscal, treatment, ref = 2014)2015       0.19          0.47 *       0.19         0.18   
                                               (0.19)        (0.22)       (0.19)       (0.19)  
i(anio_fiscal, treatment, ref = 2014)2016       0.25          0.37         0.15         0.15   
                                               (0.24)        (0.32)       (0.26)       (0.25)  
i(anio_fiscal, treatment, ref = 2014)2017       0.13          0.21         0.02         0.01   
                                               (0.25)        (0.35)       (0.28)       (0.27)  
i(anio_fiscal, treatment, ref = 2014)2018      -0.49         -0.50        -0.67        -0.68 * 
                                               (0.30)        (0.42)       (0.35)       (0.33)  
i(anio_fiscal, treatment, ref = 2014)2019       0.21          0.71         0.19         0.17   
                                               (0.32)        (0.43)       (0.37)       (0.35)  
-----------------------------------------------------------------------------------------------
r.squared                                       0.02          0.01         0.01         0.02   
adj.r.squared                                   0.02          0.00         0.00         0.01   
sigma                                           3.19          3.04         3.07         3.09   
statistic                                      13.02          1.60         1.94         6.30   
p.value                                         0.00          0.11         0.04         0.00   
df                                              9             9            9            9      
logLik                                     -17276.19      -4939.90     -6013.15     -8621.88   
AIC                                         34574.39       9901.81     12048.30     17265.75   
BIC                                         34649.29       9963.17     12111.78     17333.16   
deviance                                    68206.83      17923.68     22222.87     32279.56   
df.residual                                  6688          1945         2359         3376      
nobs                                         6698          1955         2369         3386      
===============================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>es_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> fml_event_study)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-with-fixed-effects" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="event-study-design-with-fixed-effects"><span class="header-section-number">1.2</span> Event Study design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================================================================
                                           All firms    Treatment A  Treatment B  Treatment C
---------------------------------------------------------------------------------------------
anio_fiscal2013                                0.07       -0.04        -0.04        -0.18    
                                              (0.10)      (0.18)       (0.18)       (0.15)   
anio_fiscal2014                                0.29 **     0.31         0.31         0.07    
                                              (0.11)      (0.22)       (0.22)       (0.16)   
anio_fiscal2015                                0.03       -0.01        -0.01        -0.13    
                                              (0.11)      (0.24)       (0.24)       (0.18)   
anio_fiscal2016                               -0.11       -0.21        -0.21        -0.27    
                                              (0.12)      (0.23)       (0.23)       (0.19)   
anio_fiscal2017                               -0.14       -0.21        -0.21        -0.36    
                                              (0.13)      (0.27)       (0.27)       (0.20)   
anio_fiscal2018                               -0.12        0.09         0.09        -0.14    
                                              (0.13)      (0.28)       (0.28)       (0.21)   
anio_fiscal2019                               -0.11        0.05         0.05        -0.16    
                                              (0.14)      (0.29)       (0.29)       (0.23)   
i(anio_fiscal, treatment, ref = 2014)2012      0.27        0.31         0.22        -0.02    
                                              (0.25)      (0.38)       (0.31)       (0.28)   
i(anio_fiscal, treatment, ref = 2014)2013      0.19        0.37         0.30         0.20    
                                              (0.21)      (0.30)       (0.25)       (0.23)   
i(anio_fiscal, treatment, ref = 2014)2015      0.04        0.33         0.10        -0.03    
                                              (0.18)      (0.25)       (0.22)       (0.21)   
i(anio_fiscal, treatment, ref = 2014)2016      0.02        0.31         0.08        -0.11    
                                              (0.22)      (0.31)       (0.27)       (0.25)   
i(anio_fiscal, treatment, ref = 2014)2017      0.22        0.31         0.22         0.13    
                                              (0.23)      (0.35)       (0.29)       (0.26)   
i(anio_fiscal, treatment, ref = 2014)2018     -0.13       -0.31        -0.41        -0.43    
                                              (0.28)      (0.41)       (0.35)       (0.32)   
i(anio_fiscal, treatment, ref = 2014)2019      0.18        0.25         0.08         0.05    
                                              (0.30)      (0.43)       (0.37)       (0.35)   
---------------------------------------------------------------------------------------------
r.squared                                      0.01        0.01         0.01         0.01    
adj.r.squared                                 -0.40       -0.39        -0.37        -0.40    
statistic                                      2.36        1.20         1.70         1.65    
p.value                                        0.00        0.27         0.05         0.06    
deviance                                   14839.73     3870.92      4526.47      6943.17    
df.residual                                 4740        1394         1700         2401       
nobs                                        6698        1955         2369         3386       
=============================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>es_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml_event_study,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_fe,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-unsaturated-model" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="event-study-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.3</span> Event Study design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================================
                             All firms      Treatment A  Treatment B  Treatment C
---------------------------------------------------------------------------------
(Intercept)                     178.02 ***    112.95       112.95        99.12   
                                (41.40)       (85.63)      (85.61)      (63.90)  
anio_fiscal                      -0.08 ***     -0.05        -0.05        -0.04   
                                 (0.02)        (0.04)       (0.04)       (0.03)  
treatment                         0.89 ***     -0.12         0.26         0.75 **
                                 (0.26)        (0.37)       (0.32)       (0.29)  
anio_fiscal::2012:treatment      -0.39         -0.39        -0.34        -0.33   
                                 (0.27)        (0.37)       (0.29)       (0.29)  
anio_fiscal::2013:treatment      -0.11          0.12        -0.03        -0.03   
                                 (0.23)        (0.31)       (0.24)       (0.24)  
anio_fiscal::2015:treatment       0.19          0.44 *       0.20         0.19   
                                 (0.19)        (0.22)       (0.19)       (0.19)  
anio_fiscal::2016:treatment       0.22          0.34         0.12         0.11   
                                 (0.25)        (0.32)       (0.26)       (0.26)  
anio_fiscal::2017:treatment       0.15          0.21         0.03         0.01   
                                 (0.26)        (0.36)       (0.29)       (0.28)  
anio_fiscal::2018:treatment      -0.51         -0.53        -0.71 *      -0.74 * 
                                 (0.31)        (0.42)       (0.35)       (0.33)  
anio_fiscal::2019:treatment       0.21          0.68         0.17         0.14   
                                 (0.32)        (0.43)       (0.38)       (0.35)  
---------------------------------------------------------------------------------
r.squared                         0.02          0.01         0.01         0.02   
adj.r.squared                     0.01          0.00         0.00         0.01   
sigma                            12.39         11.67        11.86        11.89   
logLik                       -17283.15      -4941.50     -6015.12     -8624.63   
AIC                           34586.30       9903.00     12050.24     17269.25   
BIC                           34654.39       9958.78     12107.94     17330.52   
nobs                           6698          1955         2369         3386      
=================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>es_model_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fml =</span> fml_event_study,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-with-fixed-effects" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="event-study-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.4</span> Event Study design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================
                             All firms   Treatment A  Treatment B  Treatment C
------------------------------------------------------------------------------
anio_fiscal::2012:treatment       0.27       0.31         0.22        -0.04   
                                 (0.25)     (0.39)       (0.32)       (0.29)  
anio_fiscal::2013:treatment       0.18       0.36         0.28         0.16   
                                 (0.22)     (0.31)       (0.26)       (0.24)  
anio_fiscal::2015:treatment       0.04       0.34         0.12        -0.02   
                                 (0.18)     (0.25)       (0.23)       (0.21)  
anio_fiscal::2016:treatment      -0.01       0.32         0.07        -0.18   
                                 (0.23)     (0.32)       (0.28)       (0.26)  
anio_fiscal::2017:treatment       0.22       0.33         0.23         0.11   
                                 (0.24)     (0.36)       (0.31)       (0.28)  
anio_fiscal::2018:treatment      -0.15      -0.33        -0.46        -0.50   
                                 (0.29)     (0.42)       (0.36)       (0.33)  
anio_fiscal::2019:treatment       0.19       0.25         0.06         0.02   
                                 (0.31)     (0.43)       (0.39)       (0.37)  
------------------------------------------------------------------------------
r.squared                         0.78       0.78         0.79         0.78   
adj.r.squared                     0.69       0.69         0.71         0.69   
sigma                             6.96       6.49         6.38         6.64   
logLik                       -12168.25   -3441.81     -4128.49     -6020.41   
AIC                           28252.51    8005.63      9594.98     14010.81   
BIC                           41585.63   11134.97     13455.26     20046.31   
nobs                           6698       1955         2369         3386      
within.r.squared                  0.00       0.01         0.00         0.00   
==============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  fml_event_study_fe <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  i(anio_fiscal,treatment, ref = 2014) | firm_id + anio_fiscal'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>es_model_aw_fe <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fml =</span> fml_event_study_fe,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw_fe,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-unsaturated-model" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="diff-in-diff-design-unsaturated-model"><span class="header-section-number">1.5</span> Diff-in-diff design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================
                    All firms      Treatment A   Treatment B   Treatment C 
---------------------------------------------------------------------------
(Intercept)              9.99 ***     10.59 ***     10.59 ***     10.13 ***
                        (0.10)        (0.22)        (0.22)        (0.16)   
treatment                0.79 ***     -0.14          0.19          0.64 *  
                        (0.22)        (0.33)        (0.30)        (0.26)   
postPost                -0.30 ***     -0.19         -0.19         -0.21    
                        (0.09)        (0.19)        (0.19)        (0.14)   
treatment:postPost       0.19          0.30          0.07          0.10    
                        (0.20)        (0.30)        (0.27)        (0.24)   
---------------------------------------------------------------------------
r.squared                0.01          0.00          0.00          0.01    
adj.r.squared            0.01         -0.00          0.00          0.01    
sigma                    3.20          3.04          3.07          3.10    
statistic               32.89          0.45          1.55         14.73    
p.value                  0.00          0.72          0.20          0.00    
df                       3             3             3             3       
logLik              -17285.38      -4946.42      -6019.58      -8628.08    
AIC                  34580.76       9902.83      12049.15      17266.17    
BIC                  34614.81       9930.72      12078.00      17296.81    
deviance             68394.15      18043.51      22343.73      32398.13    
df.residual           6694          1951          2365          3382       
nobs                  6698          1955          2369          3386       
===========================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> fml)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-with-fixed-effects" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="diff-in-diff-design-with-fixed-effects"><span class="header-section-number">1.6</span> Diff-in-diff design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================
                    All firms    Treatment A  Treatment B  Treatment C
----------------------------------------------------------------------
postPost               -0.21 **    -0.17        -0.17        -0.18    
                       (0.08)      (0.16)       (0.16)       (0.12)   
treatment:postPost     -0.08       -0.02        -0.14        -0.13    
                       (0.18)      (0.26)       (0.23)       (0.21)   
----------------------------------------------------------------------
r.squared               0.00        0.00         0.01         0.00    
adj.r.squared          -0.40       -0.39        -0.38        -0.40    
statistic               9.16        1.85         4.69         5.27    
p.value                 0.00        0.16         0.01         0.01    
deviance            14885.96     3907.19      4564.81      6979.47    
df.residual          4752        1406         1712         2413       
nobs                 6698        1955         2369         3386       
======================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>did_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-unsaturated-model" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.7</span> Diff-in-diff design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span> <span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================================================
                    All firms       Treatment A    Treatment B    Treatment C  
-------------------------------------------------------------------------------
(Intercept)              10.14 ***      10.73 ***      10.73 ***      10.25 ***
                         (0.11)         (0.23)         (0.23)         (0.16)   
treatment                 0.75 **       -0.19           0.15           0.63 *  
                         (0.23)         (0.34)         (0.31)         (0.27)   
postPost                 -0.30 ***      -0.19          -0.19          -0.20    
                         (0.09)         (0.19)         (0.19)         (0.14)   
treatment:postPost        0.19           0.29           0.07           0.08    
                         (0.21)         (0.30)         (0.27)         (0.24)   
-------------------------------------------------------------------------------
r.squared                 0.01           0.00           0.00           0.01    
adj.r.squared             0.01          -0.00           0.00           0.01    
sigma                    12.40          11.69          11.88          11.90    
statistic                30.18           0.39           1.22          13.52    
p.value                   0.00           0.76           0.30           0.00    
df                        3              3              3              3       
logLik               -17367.85       -4968.62       -6052.49       -8667.03    
AIC                   34745.71        9947.24       12114.97       17344.06    
BIC                   34779.76        9975.14       12143.82       17374.70    
deviance            1029245.93      266839.78      333601.96      478846.72    
df.residual            6694           1951           2365           3382       
nobs                   6698           1955           2369           3386       
===============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>did_model_aw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> fml,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> assets_2014)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-with-fixed-effects" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.8</span> Diff-in-diff design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=====================================================================
                    All firms   Treatment A  Treatment B  Treatment C
---------------------------------------------------------------------
treatment:postPost      -0.08      -0.01        -0.13        -0.15   
                        (0.18)     (0.27)       (0.24)       (0.22)  
---------------------------------------------------------------------
r.squared                0.78       0.78         0.79         0.78   
adj.r.squared            0.69       0.69         0.71         0.69   
sigma                    6.96       6.49         6.38         6.65   
logLik              -12171.34   -3446.75     -4133.30     -6024.85   
AIC                  28246.67    8003.50      9592.60     14007.70   
BIC                  41538.94   11099.37     13418.26     20006.43   
nobs                  6698       1955         2369         3386      
within.r.squared         0.00       0.00         0.00         0.00   
=====================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>did_model_fe_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fml =</span> fml_fe,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="major-groups-t-maj-vs-c-maj" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Major groups (T-Maj vs C-Maj)</h1>
<section id="event-study-design-unsaturated-model-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="event-study-design-unsaturated-model-1"><span class="header-section-number">2.1</span> Event Study design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================================================================
                                           All firms      Treatment A  Treatment B  Treatment C
-----------------------------------------------------------------------------------------------
(Intercept)                                   190.83 ***     81.50        81.50       113.25   
                                              (48.62)       (94.25)      (94.19)      (72.08)  
anio_fiscal                                    -0.09 ***     -0.04        -0.04        -0.05   
                                               (0.02)        (0.05)       (0.05)       (0.04)  
treatment                                       0.99 ***      0.04         0.43         0.88 **
                                               (0.29)        (0.40)       (0.35)       (0.32)  
i(anio_fiscal, treatment, ref = 2014)2012      -0.50         -0.43        -0.40        -0.43   
                                               (0.33)        (0.45)       (0.34)       (0.33)  
i(anio_fiscal, treatment, ref = 2014)2013      -0.11          0.01        -0.10        -0.12   
                                               (0.28)        (0.36)       (0.28)       (0.28)  
i(anio_fiscal, treatment, ref = 2014)2015       0.18          0.46         0.13         0.15   
                                               (0.21)        (0.25)       (0.22)       (0.22)  
i(anio_fiscal, treatment, ref = 2014)2016       0.09          0.08        -0.02         0.01   
                                               (0.29)        (0.37)       (0.30)       (0.29)  
i(anio_fiscal, treatment, ref = 2014)2017      -0.07         -0.24        -0.26        -0.21   
                                               (0.30)        (0.39)       (0.32)       (0.31)  
i(anio_fiscal, treatment, ref = 2014)2018      -0.78 *       -1.06 *      -1.04 **     -0.97 **
                                               (0.35)        (0.48)       (0.39)       (0.37)  
i(anio_fiscal, treatment, ref = 2014)2019       0.31          0.36         0.04         0.12   
                                               (0.37)        (0.49)       (0.42)       (0.39)  
-----------------------------------------------------------------------------------------------
r.squared                                       0.02          0.01         0.01         0.02   
adj.r.squared                                   0.02          0.00         0.00         0.01   
sigma                                           3.24          3.09         3.10         3.13   
statistic                                       9.42          1.77         1.94         5.15   
p.value                                         0.00          0.07         0.04         0.00   
df                                              9             9            9            9      
logLik                                     -12840.31      -3926.11     -4710.99     -6733.21   
AIC                                         25702.63       7874.22      9443.99     13488.42   
BIC                                         25774.21       7932.98      9504.74     13553.05   
deviance                                    51822.50      14616.24     17680.98     25694.75   
df.residual                                  4942          1534         1839         2622      
nobs                                         4952          1544         1849         2632      
===============================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>es_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> fml_event_study)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-with-fixed-effects-1" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="event-study-design-with-fixed-effects-1"><span class="header-section-number">2.2</span> Event Study design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================================================================
                                           All firms    Treatment A  Treatment B  Treatment C
---------------------------------------------------------------------------------------------
anio_fiscal2013                                0.18       -0.02        -0.02        -0.16    
                                              (0.12)      (0.19)       (0.19)       (0.16)   
anio_fiscal2014                                0.33 **     0.25         0.25         0.07    
                                              (0.13)      (0.23)       (0.23)       (0.19)   
anio_fiscal2015                               -0.04       -0.05        -0.05        -0.20    
                                              (0.13)      (0.26)       (0.26)       (0.20)   
anio_fiscal2016                               -0.13       -0.27        -0.27        -0.35    
                                              (0.14)      (0.26)       (0.25)       (0.22)   
anio_fiscal2017                               -0.13       -0.22        -0.22        -0.35    
                                              (0.15)      (0.29)       (0.29)       (0.23)   
anio_fiscal2018                               -0.09        0.20         0.20        -0.14    
                                              (0.15)      (0.29)       (0.29)       (0.22)   
anio_fiscal2019                               -0.07        0.16         0.16        -0.11    
                                              (0.16)      (0.32)       (0.32)       (0.25)   
i(anio_fiscal, treatment, ref = 2014)2012      0.29        0.21         0.20         0.02    
                                              (0.31)      (0.47)       (0.37)       (0.34)   
i(anio_fiscal, treatment, ref = 2014)2013      0.24        0.45         0.31         0.28    
                                              (0.26)      (0.36)       (0.28)       (0.27)   
i(anio_fiscal, treatment, ref = 2014)2015      0.15        0.31         0.08         0.05    
                                              (0.21)      (0.29)       (0.25)       (0.23)   
i(anio_fiscal, treatment, ref = 2014)2016      0.10        0.33         0.15         0.05    
                                              (0.26)      (0.36)       (0.31)       (0.29)   
i(anio_fiscal, treatment, ref = 2014)2017      0.16        0.16         0.13         0.08    
                                              (0.27)      (0.39)       (0.34)       (0.30)   
i(anio_fiscal, treatment, ref = 2014)2018     -0.26       -0.68        -0.67        -0.51    
                                              (0.33)      (0.47)       (0.39)       (0.36)   
i(anio_fiscal, treatment, ref = 2014)2019      0.17       -0.20        -0.17        -0.07    
                                              (0.36)      (0.50)       (0.42)       (0.40)   
---------------------------------------------------------------------------------------------
r.squared                                      0.01        0.02         0.02         0.01    
adj.r.squared                                 -0.40       -0.37        -0.37        -0.39    
statistic                                      2.35        1.44         1.62         1.56    
p.value                                        0.00        0.13         0.07         0.08    
deviance                                   11260.35     3135.69      3569.46      5435.16    
df.residual                                 3498        1103         1325         1867       
nobs                                        4952        1544         1849         2632       
=============================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>es_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml_event_study,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_fe,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-unsaturated-model-1" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="event-study-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.3</span> Event Study design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================================
                             All firms      Treatment A  Treatment B  Treatment C
---------------------------------------------------------------------------------
(Intercept)                     194.68 ***     79.45        79.45       103.08   
                                (49.08)       (93.08)      (93.06)      (71.46)  
anio_fiscal                      -0.09 ***     -0.03        -0.03        -0.05   
                                 (0.02)        (0.05)       (0.05)       (0.04)  
treatment                         0.92 **      -0.02         0.38         0.84 * 
                                 (0.31)        (0.42)       (0.37)       (0.33)  
anio_fiscal::2012:treatment      -0.50         -0.43        -0.40        -0.43   
                                 (0.34)        (0.46)       (0.35)       (0.34)  
anio_fiscal::2013:treatment      -0.10          0.02        -0.09        -0.10   
                                 (0.29)        (0.37)       (0.29)       (0.29)  
anio_fiscal::2015:treatment       0.20          0.44         0.14         0.16   
                                 (0.22)        (0.26)       (0.22)       (0.22)  
anio_fiscal::2016:treatment       0.06          0.06        -0.05        -0.03   
                                 (0.30)        (0.38)       (0.31)       (0.30)  
anio_fiscal::2017:treatment      -0.05         -0.23        -0.25        -0.22   
                                 (0.30)        (0.40)       (0.33)       (0.32)  
anio_fiscal::2018:treatment      -0.78 *       -1.06 *      -1.06 **     -1.01 **
                                 (0.37)        (0.49)       (0.40)       (0.38)  
anio_fiscal::2019:treatment       0.34          0.35         0.05         0.11   
                                 (0.38)        (0.50)       (0.43)       (0.40)  
---------------------------------------------------------------------------------
r.squared                         0.02          0.01         0.01         0.02   
adj.r.squared                     0.01          0.00         0.00         0.01   
sigma                            12.55         11.85        11.96        12.01   
logLik                       -12845.35      -3927.35     -4712.46     -6735.49   
AIC                           25710.70       7874.69      9444.91     13490.97   
BIC                           25775.77       7928.11      9500.14     13549.73   
nobs                           4952          1544         1849         2632      
=================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>es_model_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fml =</span> fml_event_study,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-with-fixed-effects-1" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="event-study-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.4</span> Event Study design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================================================
                             All firms  Treatment A  Treatment B  Treatment C
-----------------------------------------------------------------------------
anio_fiscal::2012:treatment      0.30       0.22         0.21         0.03   
                                (0.32)     (0.48)       (0.38)       (0.35)  
anio_fiscal::2013:treatment      0.22       0.43         0.29         0.25   
                                (0.27)     (0.37)       (0.29)       (0.29)  
anio_fiscal::2015:treatment      0.15       0.32         0.10         0.08   
                                (0.21)     (0.29)       (0.26)       (0.24)  
anio_fiscal::2016:treatment      0.07       0.36         0.17         0.01   
                                (0.27)     (0.37)       (0.32)       (0.30)  
anio_fiscal::2017:treatment      0.17       0.18         0.14         0.07   
                                (0.28)     (0.41)       (0.35)       (0.32)  
anio_fiscal::2018:treatment     -0.26      -0.67        -0.67        -0.54   
                                (0.35)     (0.48)       (0.41)       (0.37)  
anio_fiscal::2019:treatment      0.18      -0.19        -0.16        -0.08   
                                (0.37)     (0.51)       (0.44)       (0.41)  
-----------------------------------------------------------------------------
r.squared                        0.78       0.78         0.80         0.79   
adj.r.squared                    0.69       0.69         0.72         0.70   
sigma                            7.05       6.56         6.40         6.64   
logLik                       -9060.69   -2737.82     -3231.77     -4689.01   
AIC                          21029.39    6357.64      7511.55     10908.02   
BIC                          30491.36    8713.52     10405.29     15402.78   
nobs                          4952       1544         1849         2632      
within.r.squared                 0.00       0.01         0.01         0.00   
=============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  fml_event_study_fe <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  i(anio_fiscal,treatment, ref = 2014) | firm_id + anio_fiscal'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>es_model_aw_fe <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fml =</span> fml_event_study_fe,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw_fe,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-unsaturated-model-1" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="diff-in-diff-design-unsaturated-model-1"><span class="header-section-number">2.5</span> Diff-in-diff design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================
                    All firms      Treatment A   Treatment B   Treatment C 
---------------------------------------------------------------------------
(Intercept)             10.12 ***     10.61 ***     10.61 ***     10.23 ***
                        (0.12)        (0.24)        (0.24)        (0.18)   
treatment                0.80 **      -0.06          0.30          0.68 *  
                        (0.27)        (0.38)        (0.34)        (0.30)   
postPost                -0.35 **      -0.10         -0.10         -0.25    
                        (0.11)        (0.21)        (0.21)        (0.16)   
treatment:postPost       0.13          0.00         -0.11          0.04    
                        (0.25)        (0.35)        (0.31)        (0.28)   
---------------------------------------------------------------------------
r.squared                0.01          0.00          0.00          0.01    
adj.r.squared            0.01         -0.00          0.00          0.01    
sigma                    3.24          3.10          3.11          3.13    
statistic               22.55          0.19          1.19         11.10    
p.value                  0.00          0.90          0.31          0.00    
df                       3             3             3             3       
logLik              -12848.79      -3933.78      -4717.92      -6739.69    
AIC                  25707.58       7877.56       9445.85      13489.38    
BIC                  25740.12       7904.27       9473.46      13518.75    
deviance             52000.23      14762.21      17814.01      25821.58    
df.residual           4948          1540          1845          2628       
nobs                  4952          1544          1849          2632       
===========================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> fml)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-with-fixed-effects-1" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="diff-in-diff-design-with-fixed-effects-1"><span class="header-section-number">2.6</span> Diff-in-diff design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================
                    All firms    Treatment A  Treatment B  Treatment C
----------------------------------------------------------------------
postPost               -0.27 **    -0.13        -0.13        -0.21    
                       (0.09)      (0.18)       (0.18)       (0.14)   
treatment:postPost     -0.09       -0.19        -0.23        -0.16    
                       (0.21)      (0.31)       (0.26)       (0.23)   
----------------------------------------------------------------------
r.squared               0.01        0.00         0.01         0.01    
adj.r.squared          -0.40       -0.38        -0.37        -0.39    
statistic              10.38        2.34         4.26         5.58    
p.value                 0.00        0.10         0.01         0.00    
deviance            11299.23     3179.61      3607.67      5466.11    
df.residual          3510        1115         1337         1879       
nobs                 4952        1544         1849         2632       
======================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>did_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-unsaturated-model-1" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.7</span> Diff-in-diff design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span> <span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================
                    All firms      Treatment A    Treatment B    Treatment C  
------------------------------------------------------------------------------
(Intercept)             10.28 ***      10.76 ***      10.76 ***      10.37 ***
                        (0.13)         (0.25)         (0.25)         (0.18)   
treatment                0.74 **       -0.13           0.24           0.64 *  
                        (0.28)         (0.39)         (0.35)         (0.31)   
postPost                -0.36 ***      -0.12          -0.12          -0.24    
                        (0.11)         (0.21)         (0.21)         (0.16)   
treatment:postPost       0.14           0.01          -0.09           0.03    
                        (0.25)         (0.36)         (0.31)         (0.28)   
------------------------------------------------------------------------------
r.squared                0.01           0.00           0.00           0.01    
adj.r.squared            0.01          -0.00          -0.00           0.01    
sigma                   12.57          11.88          11.99          12.02    
statistic               20.26           0.39           0.91           9.68    
p.value                  0.00           0.76           0.44           0.00    
df                       3              3              3              3       
logLik              -12919.93       -3951.66       -4746.16       -6771.69    
AIC                  25849.86        7913.32        9502.33       13553.38    
BIC                  25882.40        7940.03        9529.94       13582.75    
deviance            781618.58      217416.83      265282.96      380001.27    
df.residual           4948           1540           1845           2628       
nobs                  4952           1544           1849           2632       
==============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>did_model_aw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> fml,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> assets_2014)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-with-fixed-effects-1" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.8</span> Diff-in-diff design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================
                    All firms    Treatment A  Treatment B  Treatment C
----------------------------------------------------------------------
treatment                -0.44                                        
                    (917573.09)                                       
treatment:postPost       -0.08      -0.17        -0.21        -0.16   
                         (0.22)     (0.33)       (0.27)       (0.25)  
----------------------------------------------------------------------
r.squared                 0.78       0.78         0.79         0.79   
adj.r.squared             0.69       0.69         0.71         0.70   
sigma                     7.05       6.57         6.40         6.64   
logLik                -9063.90   -2745.82     -3238.44     -4693.59   
AIC                   21025.81    6361.65      7512.87     10905.18   
BIC                   30455.24    8685.48     10373.47     15364.69   
nobs                   4952       1544         1849         2632      
within.r.squared          0.00       0.00         0.00         0.00   
======================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>did_model_fe_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fml =</span> fml_fe,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="minor-groups-t-min-vs-c-min" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Minor groups (T-Min vs C-Min)</h1>
<section id="event-study-design-unsaturated-model-2" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="event-study-design-unsaturated-model-2"><span class="header-section-number">3.1</span> Event Study design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================================
                                           All firms  Treatment A  Treatment B  Treatment C
-------------------------------------------------------------------------------------------
(Intercept)                                  148.97     295.89       295.89       101.00   
                                             (76.68)   (216.04)     (215.38)     (140.26)  
anio_fiscal                                   -0.07      -0.14        -0.14        -0.05   
                                              (0.04)     (0.11)       (0.11)       (0.07)  
treatment                                      0.84      -0.30         0.00         0.58   
                                              (0.50)     (0.80)       (0.68)       (0.58)  
i(anio_fiscal, treatment, ref = 2014)2012     -0.07      -0.31        -0.25        -0.06   
                                              (0.47)     (0.67)       (0.55)       (0.53)  
i(anio_fiscal, treatment, ref = 2014)2013     -0.00       0.34         0.14         0.24   
                                              (0.41)     (0.60)       (0.46)       (0.45)  
i(anio_fiscal, treatment, ref = 2014)2015      0.20       0.50         0.30         0.21   
                                              (0.39)     (0.46)       (0.43)       (0.42)  
i(anio_fiscal, treatment, ref = 2014)2016      0.65       1.28 *       0.69         0.50   
                                              (0.45)     (0.62)       (0.53)       (0.50)  
i(anio_fiscal, treatment, ref = 2014)2017      0.61       1.53 *       0.88         0.59   
                                              (0.49)     (0.77)       (0.62)       (0.57)  
i(anio_fiscal, treatment, ref = 2014)2018      0.25       1.27         0.53         0.14   
                                              (0.57)     (0.84)       (0.75)       (0.67)  
i(anio_fiscal, treatment, ref = 2014)2019      0.06       1.80 *       0.80         0.32   
                                              (0.62)     (0.90)       (0.84)       (0.74)  
-------------------------------------------------------------------------------------------
r.squared                                      0.02       0.03         0.01         0.02   
adj.r.squared                                  0.02       0.01        -0.01         0.01   
sigma                                          3.05       2.82         2.96         2.95   
statistic                                      4.87       1.26         0.64         1.87   
p.value                                        0.00       0.26         0.76         0.05   
df                                             9          9            9            9      
logLik                                     -4419.27   -1004.58     -1296.65     -1881.77   
AIC                                         8860.53    2031.16      2615.29      3785.54   
BIC                                         8920.65    2075.36      2662.09      3836.42   
deviance                                   16145.02    3194.46      4460.67      6496.07   
df.residual                                 1736        401          510          744      
nobs                                        1746        411          520          754      
===========================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>es_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> fml_event_study)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-with-fixed-effects-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="event-study-design-with-fixed-effects-2"><span class="header-section-number">3.2</span> Event Study design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================================
                                           All firms  Treatment A  Treatment B  Treatment C
-------------------------------------------------------------------------------------------
anio_fiscal2013                              -0.25     -0.26        -0.26         -0.25    
                                             (0.19)    (0.57)       (0.57)        (0.33)   
anio_fiscal2014                               0.15      0.73         0.73          0.06    
                                             (0.21)    (0.60)       (0.60)        (0.34)   
anio_fiscal2015                               0.23      0.19         0.19          0.19    
                                             (0.22)    (0.56)       (0.56)        (0.40)   
anio_fiscal2016                              -0.03     -0.02        -0.02          0.09    
                                             (0.24)    (0.56)       (0.56)        (0.43)   
anio_fiscal2017                              -0.18     -0.26        -0.26         -0.38    
                                             (0.27)    (0.61)       (0.61)        (0.49)   
anio_fiscal2018                              -0.23     -0.62        -0.62         -0.16    
                                             (0.27)    (0.81)       (0.81)        (0.55)   
anio_fiscal2019                              -0.20     -0.54        -0.54         -0.32    
                                             (0.28)    (0.68)       (0.68)        (0.59)   
i(anio_fiscal, treatment, ref = 2014)2012     0.22      0.85         0.57         -0.10    
                                             (0.42)    (0.77)       (0.71)        (0.52)   
i(anio_fiscal, treatment, ref = 2014)2013     0.16      0.63         0.71          0.03    
                                             (0.37)    (0.68)       (0.62)        (0.45)   
i(anio_fiscal, treatment, ref = 2014)2015    -0.31      0.49         0.29         -0.38    
                                             (0.34)    (0.48)       (0.44)        (0.44)   
i(anio_fiscal, treatment, ref = 2014)2016    -0.22      0.40         0.06         -0.73    
                                             (0.41)    (0.57)       (0.49)        (0.53)   
i(anio_fiscal, treatment, ref = 2014)2017     0.31      0.99         0.76          0.21    
                                             (0.43)    (0.66)       (0.55)        (0.54)   
i(anio_fiscal, treatment, ref = 2014)2018     0.14      1.35         0.94         -0.20    
                                             (0.51)    (0.84)       (0.76)        (0.70)   
i(anio_fiscal, treatment, ref = 2014)2019     0.18      1.96 *       1.26          0.37    
                                             (0.55)    (0.78)       (0.74)        (0.73)   
-------------------------------------------------------------------------------------------
r.squared                                     0.01      0.05         0.03          0.02    
adj.r.squared                                -0.41     -0.41        -0.39         -0.42    
statistic                                     0.92      1.04         0.88          0.62    
p.value                                       0.53      0.42         0.58          0.85    
deviance                                   3540.06    688.47       927.43       1486.42    
df.residual                                1228       277          361           520       
nobs                                       1746       411          520           754       
===========================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>es_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml_event_study,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_fe,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-unsaturated-model-2" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="event-study-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.3</span> Event Study design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================================================
                             All firms  Treatment A  Treatment B  Treatment C
-----------------------------------------------------------------------------
(Intercept)                    134.01     252.92       252.92        69.01   
                               (76.20)   (217.03)     (216.87)     (140.56)  
anio_fiscal                     -0.06      -0.12        -0.12        -0.03   
                                (0.04)     (0.11)       (0.11)       (0.07)  
treatment                        0.87      -0.24         0.08         0.68   
                                (0.50)     (0.81)       (0.71)       (0.58)  
anio_fiscal::2012:treatment     -0.08      -0.30        -0.21        -0.03   
                                (0.48)     (0.67)       (0.55)       (0.52)  
anio_fiscal::2013:treatment     -0.01       0.37         0.15         0.25   
                                (0.41)     (0.58)       (0.45)       (0.44)  
anio_fiscal::2015:treatment      0.16       0.45         0.30         0.20   
                                (0.38)     (0.45)       (0.42)       (0.41)  
anio_fiscal::2016:treatment      0.58       1.16         0.61         0.43   
                                (0.44)     (0.61)       (0.51)       (0.49)  
anio_fiscal::2017:treatment      0.60       1.42         0.83         0.56   
                                (0.49)     (0.76)       (0.61)       (0.56)  
anio_fiscal::2018:treatment      0.12       1.05         0.35        -0.02   
                                (0.57)     (0.84)       (0.75)       (0.67)  
anio_fiscal::2019:treatment      0.01       1.64         0.64         0.19   
                                (0.63)     (0.90)       (0.85)       (0.74)  
-----------------------------------------------------------------------------
r.squared                        0.02       0.02         0.01         0.02   
adj.r.squared                    0.02       0.00        -0.01         0.01   
sigma                           11.85      10.96        11.49        11.45   
logLik                       -4421.43   -1004.93     -1297.21     -1882.37   
AIC                           8862.85    2029.86      2614.43      3784.75   
BIC                           8917.50    2070.04      2656.97      3831.00   
nobs                          1746        411          520          754      
=============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>es_model_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fml =</span> fml_event_study,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-with-fixed-effects-2" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="event-study-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.4</span> Event Study design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=============================================================================
                             All firms  Treatment A  Treatment B  Treatment C
-----------------------------------------------------------------------------
anio_fiscal::2012:treatment      0.19      0.86         0.61         -0.21   
                                (0.43)    (0.81)       (0.75)        (0.54)  
anio_fiscal::2013:treatment      0.18      0.71         0.75         -0.01   
                                (0.38)    (0.71)       (0.66)        (0.47)  
anio_fiscal::2015:treatment     -0.30      0.48         0.30         -0.45   
                                (0.35)    (0.48)       (0.44)        (0.45)  
anio_fiscal::2016:treatment     -0.27      0.30        -0.03         -0.85   
                                (0.43)    (0.57)       (0.50)        (0.55)  
anio_fiscal::2017:treatment      0.28      0.95         0.72          0.16   
                                (0.45)    (0.66)       (0.55)        (0.55)  
anio_fiscal::2018:treatment      0.07      1.12         0.69         -0.45   
                                (0.53)    (0.81)       (0.74)        (0.71)  
anio_fiscal::2019:treatment      0.17      1.83 *       1.10          0.27   
                                (0.58)    (0.76)       (0.74)        (0.77)  
-----------------------------------------------------------------------------
r.squared                        0.78      0.78         0.79          0.77   
adj.r.squared                    0.69      0.68         0.69          0.66   
sigma                            6.71      6.20         6.36          6.69   
logLik                       -3094.67   -689.43      -888.53      -1326.03   
AIC                           7225.35   1646.87      2095.06       3120.06   
BIC                          10056.26   2185.36      2771.42       4202.40   
nobs                          1746       411          520           754      
within.r.squared                 0.00      0.03         0.01          0.01   
=============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  fml_event_study_fe <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  i(anio_fiscal,treatment, ref = 2014) | firm_id + anio_fiscal'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>es_model_aw_fe <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fml =</span> fml_event_study_fe,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw_fe,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-unsaturated-model-2" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="diff-in-diff-design-unsaturated-model-2"><span class="header-section-number">3.5</span> Diff-in-diff design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==========================================================================
                    All firms     Treatment A   Treatment B   Treatment C 
--------------------------------------------------------------------------
(Intercept)             9.60 ***     10.47 ***     10.47 ***      9.73 ***
                       (0.19)        (0.51)        (0.51)        (0.33)   
treatment               0.88 *       -0.24          0.01          0.75    
                       (0.41)        (0.69)        (0.63)        (0.50)   
postPost               -0.18         -0.54         -0.54         -0.04    
                       (0.17)        (0.42)        (0.42)        (0.31)   
treatment:postPost      0.27          1.22 *        0.65          0.15    
                       (0.36)        (0.57)        (0.54)        (0.46)   
--------------------------------------------------------------------------
r.squared               0.02          0.02          0.01          0.02    
adj.r.squared           0.02          0.01          0.00          0.02    
sigma                   3.05          2.81          2.95          2.95    
statistic              12.96          2.81          1.34          5.09    
p.value                 0.00          0.04          0.26          0.00    
df                      3             3             3             3       
logLik              -4421.75      -1006.08      -1297.56      -1882.59    
AIC                  8853.50       2022.17       2605.13       3775.18    
BIC                  8880.83       2042.26       2626.39       3798.30    
deviance            16191.03       3217.95       4476.41       6510.15    
df.residual          1742           407           516           750       
nobs                 1746           411           520           754       
==========================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> fml)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-with-fixed-effects-2" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="diff-in-diff-design-with-fixed-effects-2"><span class="header-section-number">3.6</span> Diff-in-diff design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
====================================================================
                    All firms  Treatment A  Treatment B  Treatment C
--------------------------------------------------------------------
postPost              -0.03     -0.40        -0.40         -0.02    
                      (0.16)    (0.28)       (0.28)        (0.30)   
treatment:postPost    -0.12      0.53         0.24         -0.14    
                      (0.32)    (0.45)       (0.43)        (0.44)   
--------------------------------------------------------------------
r.squared              0.00      0.01         0.01          0.00    
adj.r.squared         -0.41     -0.41        -0.38         -0.41    
statistic              0.31      0.90         1.04          0.28    
p.value                0.73      0.41         0.35          0.76    
deviance            3575.47    719.99       953.89       1509.79    
df.residual         1240       289          373           532       
nobs                1746       411          520           754       
====================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>did_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-unsaturated-model-2" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.7</span> Diff-in-diff design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span> <span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================================
                    All firms      Treatment A   Treatment B   Treatment C 
---------------------------------------------------------------------------
(Intercept)              9.73 ***     10.54 ***     10.54 ***      9.77 ***
                        (0.20)        (0.56)        (0.56)        (0.34)   
treatment                0.90 *       -0.17          0.09          0.86    
                        (0.40)        (0.72)        (0.67)        (0.51)   
postPost                -0.15         -0.47         -0.47          0.03    
                        (0.17)        (0.42)        (0.42)        (0.31)   
treatment:postPost       0.23          1.09          0.56          0.05    
                        (0.36)        (0.57)        (0.54)        (0.46)   
---------------------------------------------------------------------------
r.squared                0.02          0.02          0.01          0.02    
adj.r.squared            0.02          0.01          0.00          0.02    
sigma                   11.85         10.92         11.45         11.41    
statistic               12.78          2.38          1.20          5.67    
p.value                  0.00          0.07          0.31          0.00    
df                       3             3             3             3       
logLik               -4433.59      -1011.23      -1302.88      -1889.64    
AIC                   8877.18       2032.45       2615.76       3789.29    
BIC                   8904.51       2052.55       2637.03       3812.41    
deviance            244609.76      48523.72      67621.01      97709.57    
df.residual           1742           407           516           750       
nobs                  1746           411           520           754       
===========================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>did_model_aw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> fml,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> assets_2014)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-with-fixed-effects-2" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.8</span> Diff-in-diff design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Log exits to tax haven (MID codes 1-9) ($), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Log exits to tax haven (MID codes 1-9) ($)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
====================================================================
                    All firms  Treatment A  Treatment B  Treatment C
--------------------------------------------------------------------
treatment:postPost     -0.13      0.44         0.12         -0.20   
                       (0.33)    (0.47)       (0.45)        (0.46)  
--------------------------------------------------------------------
r.squared               0.78      0.78         0.78          0.76   
adj.r.squared           0.69      0.68         0.69          0.66   
sigma                   6.70      6.21         6.34          6.69   
logLik              -3097.26   -695.16      -892.34      -1329.79   
AIC                  7218.52   1646.31      2090.68       3115.58   
BIC                 10016.64   2160.69      2741.51       4170.17   
nobs                 1746       411          520           754      
within.r.squared        0.00      0.00         0.00          0.00   
====================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>did_model_fe_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fml =</span> fml_fe,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>